{% extends "headers.html" %}
{% block content %}

<main class="dashboard-page">

  <!-- Weather Section -->
  <section class="weather-section container">
    <h2 class="section-title">ðŸŒ¤ Weather Forecast</h2>

    {% if weather_data and weather_data.get('daily') %}
      <p class="location-text">
        Showing forecast for your selected destination
      </p>

      <div class="table-responsive">
        <table class="table table-bordered table-hover weather-table">
          <thead class="table-dark">
            <tr>
              <th>Date</th>
              <th>Condition</th>
              <th>Max (Â°C)</th>
              <th>Min (Â°C)</th>
              <th>Rain %</th>
              <th>Humidity</th>
            </tr>
          </thead>
          <tbody>
            {% for day in weather_data['daily'] %}
            <tr>
              <td>{{ day['dt'] | datetimeformat }}</td>
              <td>{{ day['weather'][0]['description'] | capitalize }}</td>
              <td>{{ day['temp']['max'] }}</td>
              <td>{{ day['temp']['min'] }}</td>
              <td>{{ (day.get('pop', 0) * 100) | round }}%</td>
              <td>{{ day['humidity'] }}%</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <p class="text-muted">Weather data not available.</p>
    {% endif %}
  </section>

  <!-- Itinerary Section -->
  <section class="itinerary-section container">
    <h2 class="section-title">ðŸ§­ Your AI-Generated Itinerary</h2>

    <p class="note-text">
      This itinerary is AI-generated. You may adjust activities based on personal preference.
    </p>

    <div id="markdown-content" class="itinerary-card">
      {{ plan }}
    </div>
  </section>

  <!-- CTA Section -->
  <section class="cta-section container text-center">
    <h5>âœˆ Plan Your Stay & Flights</h5>
    <a href="https://www.booking.com" target="_blank" class="btn btn-outline-primary">
      Explore Hotels & Flights
    </a>
  </section>

</main>

<footer class="footer">
  <p>&copy; {{ now.year }} Roam-Bot â€” AI Powered Itinerary Planner</p>
</footer>

<!-- Markdown -->
<script src="https://cdn.jsdelivr.net/npm/markdown-it@11.0.1/dist/markdown-it.min.js"></script>
<script>
  const md = window.markdownit();
  const content = document.getElementById("markdown-content");
  content.innerHTML = md.render(content.textContent);
</script>

{% endblock %}
